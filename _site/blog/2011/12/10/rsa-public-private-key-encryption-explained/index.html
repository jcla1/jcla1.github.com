<!DOCTYPE html>
<!--[if lt IE 7]> <html class="lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html">
  <meta name="google-site-verification" content="xLdL56j0SwgMQ_zaX9jYVsRdm4THscM3NFAYIRhuVdg" />
  <link href="http://jcla1.com/rss.xml" rel="alternate" title="jcla1.com" type="application/atom+xml" />

	
  <title>RSA public/private key encryption explained</title>
	<meta name="description" content="A blog about tech.">
  <meta name="author" content="Joseph Adams">

  <link rel="stylesheet" href="/css/main.css" type="text/css" media="screen, projection" />
	
</head>
<body>

<div class="site">
  <div class="title">
    <a href="/">Joseph Adams</a>
    <a class="extra" href="/">home</a>
    <a class="extra" href="/about/">about</a>
    <!--a class="extra" href="/about/">about</a-->
  </div>
  
  <div id="post">
<h1 id='rsa_publicprivate_key_encryption_explained'>RSA public/private key encryption explained</h1>

<p class='meta'> 10 Dec 2011 - Krefeld, Germany</p>

<p>In this blog post I&#8217;ll show you how to calculate a simple RSA private-/public-key pair.</p>

<p>First of all you need to know that each key (the public-key and the private-key) consists of 2 parts. The first part is different in each key, the second is equal in both. So let&#8217;s start calculating!</p>

<ol>
<li>
<p>Think of 2 prime numbers.</p>

<p>In real openssl, these prime numbers are very high and have a similar bit-size. So that we have no problem doing the calculations I&#8217;ll choose 2 numbers that are quite small:<br /> <code>p = 3, q = 11</code>.</p>
</li>

<li>
<p>Calculate the modulus for the public/private key.</p>

<p>This is the number that is the same in both keys, let&#8217;s call it <code>n</code>. It is used as the modulus in en- and decryption. You calculate it by doing: <code>n = 3*11</code></p>
</li>

<li>
<p>Calculate the totient of n.</p>

<p>Calculating the totient is easy. You could use a table and look up the value, but the calculation is just as easy and faster. Just do: <code>totient(n) = (p - 1) * (q - 1)</code>. In our case we do: <code>totient(33) = (3 - 1) * (11 - 1)</code>. This equals <code>20</code>.</p>

<p>So far we have: <ul>
     <li><code>p = 3</code></li>
     <li><code>q = 11</code></li>
     <li><code>n = 33</code></li>
     <li><code>totient(n) = 20</code></li>
 </ul></p>
</li>

<li>
<p>Choose a number for <code>e</code></p>

<p>This number is is a bit harder than the others. It has to be between <code>1</code> and <code>n</code>, also coprime to <code>n</code>. This basically means that the greatest common divisor of both numbers is <code>1</code>. If you choose a prime number for <code>e</code> all you need to do now is check that <code>e</code> isn&#8217;t a divisor of <code>n</code>. I&#8217;ll choose the number: <code>e = 17</code></p>
</li>

<li>
<p>Calculating the modular multiplicative inverse of e * (mod totient(n))</p>

<p>Now at first this sounds a bit overwhelming, I struggled a bit to find out what it means. Expressed in an easy way you could say: &#8220;What is the solution to the equation:<br /> <code>(e * x - 1) mod (totient(n)) = 0</code>&#8221;. It would take quite long to work it out by hand so I wrote a small Javascript function that does the work for me: <script src='https://gist.github.com/1453094.js?file=gistfile1.js'>
 </script> The function takes 2 arguments, one is <code>e</code> the other is the <code>totient(n)</code>. Depending on your processor and the size of the numbers you choose it can take longer or shorter to run. In our case the function will log the value <code>13</code>, which I&#8217;ll call <code>d</code>. Now you have all the values needed for public-/private-key encryption or decryption.</p>
</li>

<li>
<p>Putting it all together</p>

<p>All the values up to now: <ul>
     <li><code>p = 3</code></li>
     <li><code>q = 11</code></li>
     <li><code>n = 33</code></li>
     <li><code>totient(n) = 20</code></li>
     <li><code>e = 17</code></li>
     <li><code>d = 13</code></li>
 </ul></p>

<p>Your public-key is now: <code>e = 17, n = 33</code><br /> Your private-key is now: <code>d = 13, n = 33</code></p>

<p>With this private and public-key you can now encrypt data by doing this:</p>

<p>We&#8217;ll encrypt the value <code>9</code><br /> <code>m = 9</code></p>

<p>To encrypt with the public key, you take m to the power of e (in the public-key) mod n<br /> <code>m ^ e mod n</code><br /> <code>9 ^ 17 mod 33 = 15</code></p>

<p>Our encrypted value is 15<br /> <code>c = 15</code></p>

<p>This can only be decrypted with the private-key. To decrypt it, you take c to the power of d (in the private-key) mod n<br /> <code>c ^ d mod n</code><br /> <code>15 ^ 13 mod 33 = 9</code></p>

<p>Now we have our original value!</p>

<p><em><strong>WARNING:</strong></em> The encryption in this tutorial has a very low security level, because of the low values of <code>p</code> and <code>q</code>! To improve the security level choose higher primes.</p>
</li>
</ol>
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>15 Jun 2012</span> &raquo; <a href="/blog/2012/06/15/getting-to-work-with-codemirror">Getting to work with CodeMirror</a></li>
    
      <li><span>06 Apr 2012</span> &raquo; <a href="/blog/2012/04/06/web-audio-api-overview-part2">Web Audio API overview (Part 2 of 2)</a></li>
    
      <li><span>11 Mar 2012</span> &raquo; <a href="/blog/2012/03/11/web-audio-api-overview-part1">Web Audio API overview (Part 1 of 2)</a></li>
    
  </ul>
</div>
  
  <div class="footer">
    <div class="contact">
      <p>
        Joseph Adams<br />
        <a href="mailto:whitegolem@gmail.com">whitegolem@gmail.com</a><br />
        <a href="http://jcla1.com">jcla1.com</a>
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="http://github.com/jcla1/"><img src="/img/github_32.png"></img></a>
        <a href="http://twitter.com/jcla1/"><img src="/img/twitter_32.png"></img></a>
        <a href="https://plus.google.com/109982208260057168917/posts"><img src="/img/google_32.png"></a>
      </p>
    </div>
    <div class="rss">
      <a href="http://jcla1.com/rss.xml">
        <img src="/img/rss_32.png" alt="Subscribe to RSS Feed" />
      </a>
    </div>
  </div>
</div>

<script>
    var _gaq=[['_setAccount','UA-12395541-8'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>
